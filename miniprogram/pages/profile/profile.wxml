<!--pages/profile/profile.wxml-->
<view class="profile-container">
  <scroll-view class="profile-scroll" scroll-y>
    
    <!-- æœªç™»å½•çŠ¶æ€ -->
    <view wx:if="{{!isLoggedIn}}" class="login-section">
      <view class="login-card">
        <view class="avatar-placeholder">
          <text class="avatar-icon">ğŸ‘¤</text>
        </view>
        <t-button 
          class="login-button"
          theme="success"
          size="large"
          bind:tap="onLogin"
        >
          å¾®ä¿¡ä¸€é”®ç™»å½•
        </t-button>
        <text class="login-tip">ç™»å½•åå¯æŸ¥çœ‹ä¸ªäººç”»å»Šå’Œåˆ›ä½œå†å²</text>
      </view>
    </view>

    <!-- å·²ç™»å½•çŠ¶æ€ -->
    <view wx:else>
      <!-- ç”¨æˆ·ä¿¡æ¯ -->
      <view class="user-info-section">
        <view class="user-header">
          <view class="avatar-wrapper">
            <t-avatar 
              size="large" 
              image="{{userInfo.avatar}}"
            />
            <view class="avatar-edit-btn" bindtap="onEditAvatar">
              <t-icon name="edit" size="28rpx" color="#fff" />
            </view>
          </view>
          <view class="user-details">
            <view class="user-name-wrapper">
              <text class="user-name">{{userInfo.nickname}}</text>
              <view class="name-edit-btn" bindtap="onEditNickname">
                <t-icon name="edit" size="24rpx" color="#666" />
              </view>
            </view>
            <text class="user-stats">å·²åˆ›ä½œ {{userInfo.worksCount}} å¹…ä½œå“</text>
          </view>
        </view>
      </view>

      <!-- æ•°æ®ç»Ÿè®¡ -->
      <view class="stats-section">
        <view class="stats-grid">
          <view class="stat-item">
            <text class="stat-value">{{userInfo.worksCount}}</text>
            <text class="stat-label">ä½œå“</text>
          </view>
          <view class="stat-item stat-divider">
            <text class="stat-value">{{userInfo.favoritesCount}}</text>
            <text class="stat-label">æ”¶è—</text>
          </view>
          <view class="stat-item">
            <text class="stat-value">{{userInfo.viewsCount}}</text>
            <text class="stat-label">æµè§ˆ</text>
          </view>
        </view>
      </view>

      <!-- ä¸ªäººç”»å»Š -->
      <view class="gallery-section">
        <view class="section-header">
          <text class="section-title">ä¸ªäººç”»å»Š</text>
          <text class="view-all" bindtap="onViewAllGallery">å…¨éƒ¨ â€º</text>
        </view>
        <view class="personal-gallery">
          <view 
            class="gallery-item" 
            wx:for="{{personalGallery}}" 
            wx:key="id"
            bindtap="onGalleryItemTap"
            data-item="{{item}}"
          >
            <t-image 
              class="gallery-image" 
              src="{{item.imageUrl}}" 
              mode="aspectFill"
            />
          </view>
        </view>
      </view>
    </view>

    <!-- åŠŸèƒ½åˆ—è¡¨ -->
    <view class="features-section">
      <t-cell-group>
        <t-cell 
          title="ä¸ªäººç”»å»Š" 
          left-icon="image" 
          hover
          arrow
          bind:click="onGalleryClick"
          note="{{isLoggedIn ? '' : 'ç™»å½•åæŸ¥çœ‹'}}"
        />
        <t-cell 
          title="åˆ›ä½œå†å²" 
          left-icon="edit" 
          hover
          arrow
          bind:click="onHistoryClick"
          note="{{isLoggedIn ? '' : 'ç™»å½•åæŸ¥çœ‹'}}"
        />
        <t-cell 
          title="æˆ‘çš„æ”¶è—" 
          left-icon="star" 
          hover
          arrow
          bind:click="onFavoritesClick"
          note="{{isLoggedIn ? '' : 'ç™»å½•åæŸ¥çœ‹'}}"
        />
      </t-cell-group>
    </view>

    <!-- è®¾ç½® -->
    <view class="settings-section">
      <t-cell-group>
        <t-cell 
          title="è®¾ç½®" 
          left-icon="setting" 
          hover
          arrow
          bind:click="onSettingsClick"
        />
        <t-cell 
          wx:if="{{isLoggedIn}}"
          title="é€€å‡ºç™»å½•" 
          left-icon="logout" 
          hover
          bind:click="onLogout"
        />
      </t-cell-group>
    </view>

  </scroll-view>
</view>

<!-- Toast æç¤º -->
<t-toast id="t-toast" />

